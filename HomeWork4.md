1. Создать Учебную ВМ

![Альт-текст](https://i.ibb.co/VpNQqY5/Home-Work4-1.png)

2. Зайти в созданный кластер под пользователем **_postgres_**
3. Создать новую базу данных **_testdb_**
4. Зайти в созданную базу данных под пользователем **_postgres_**
5. Создать новую схему **_testnm_**
6. Создать новую таблицу **_t1_** с одной колонкой **_c1_** типа **_integer_**
7. Вставить строку со значением **_c1=1_**
8. Создать новую роль **_readonly_**
9. Дать новой роли право на подключение к базе данных **_testdb_**
10. Дать новой роли право на использование схемы **_testnm_**
11. Дать новой роли право на select для всех таблиц схемы **_testnm_**
12. Создать пользователя **_testread_** с паролем **_test123_**
13. Дать роль readonly пользователю **_testread_**
14. Зайти под пользователем **_testread_** в базу данных **_testdb_**
15. Выполнить **_select * from t1;_**
16. Получилось? НЕТ

![Альт-текст](https://i.ibb.co/mtbS58y/Home-Work4-2.png)

17. Написать, что именно произошло?
18. Есть идеи почему? Ведь права то дали?
* как видно из скрина, таблица относится к схеме public, а на шаге 10 дали права только на схему **_testnm_**
19. Посмотреть на список таблиц.
* Уже посмотрел два раза
20. Подсказка в шпаргалке под пунктом 20.
* Не требуется, при создании было ясно, что добавляем в дефолтную схему.
21. А почему так получилось с таблицей?
* Потому что не указали явно схему, поэтому добавили в схему по умолчанию.
-------------------------------------------------------
22. Вернуться в базу данных **_testdb_** под пользователем **_postgres_**
23. Удалить таблицу **_t1_**
24. Создать ее заново, но уже с явным указанием имени схемы **_testnm_**
25. Вставить строку со значением **_c1=1_**
26. Зайти под пользователем **_testread_** в базу данных **_testdb_**
27. Выполнить **_select * from testnm.t1;_**
28. Получилось? НЕТ
29. Есть идеи почему?
* Сначала GRANT ALL, потом CREATE TABLE, на вновь созданную таблицу грант не работает
30. Как сделать так, чтобы такое больше не повторялось?
* зайти под пользователем **_postgres_** и дать права
31. Выполнить **_select * from testnm.t1;_**
32. Получилось? ДА

![Альт-текст](https://i.ibb.co/Q9s4BQt/Home-Work4-3.png)

33. Есть идеи почему?
* нужно поменять дефолтное поведение системы
34. Выполнить **_select * from testnm.t1;_**
35. Получилось?
36. Ура!
-------------------------------------------------------
37. Теперь попробуйте выполнить команду **_create table t2(c1 integer); insert into t2 values (2);_**
38. А как так? нам же никто прав на создание таблиц и **_insert_** в них под ролью **_readonly_**?
* потому что таблица по прежнему создается в дефолтной схеме
39. Есть идеи как убрать эти права?
* https://www.hippolab.ru/postgresql-prava-polzovatelya
40. Объяснить что сделали и почему выполнив указанные в ней команды?
* **_revoke CREATE on SCHEMA public FROM public;_** - отобрать право создавать в схеме public для роли public
* **_revoke all on DATABASE testdb FROM public;_** - отобрать все права на БД testdb для роли public
41. Теперь попробуйте выполнить команду **_create table t3(c1 integer); insert into t2 values (2);_**
42. Расскажите: что получилось и почему? 
* нет права создавать в схеме public (потому отобрали это право) 

![Альт-текст](https://i.ibb.co/S6q4GL6/Home-Work4-4.png)